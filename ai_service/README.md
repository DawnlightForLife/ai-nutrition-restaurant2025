# AI Nutrition Service

æ™ºèƒ½è¥å…»æ¨èå¾®æœåŠ¡ï¼ŒåŸºäºPython FastAPIæ„å»ºï¼Œæä¾›ç§‘å­¦çš„è¥å…»è®¡ç®—å’Œä¸ªæ€§åŒ–æ¨èåŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ§  ç§‘å­¦è¥å…»è®¡ç®—ï¼ˆMifflin-St Jeoræ–¹ç¨‹ï¼‰
- ğŸ½ï¸ ä¸ªæ€§åŒ–é¥®é£Ÿæ¨è
- ğŸ“Š è¥å…»ç›®æ ‡è®¾å®š
- ğŸ”„ ç”¨æˆ·åé¦ˆæ”¶é›†
- ğŸ¥ å¥åº·çŠ¶å†µè€ƒè™‘
- ğŸš« è¿‡æ•åŸé¿å…

## æ¶æ„è®¾è®¡

```
ai_service/
â”œâ”€â”€ main.py                    # FastAPIåº”ç”¨ä¸»æ–‡ä»¶
â”œâ”€â”€ requirements.txt           # Pythonä¾èµ–
â”œâ”€â”€ Dockerfile                # Dockerå®¹å™¨é…ç½®
â”œâ”€â”€ services/                  # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ nutrition_calculator.py  # è¥å…»è®¡ç®—æ ¸å¿ƒ
â”‚   â””â”€â”€ recommendation_engine.py # æ¨èå¼•æ“ï¼ˆæœªæ¥æ‰©å±•ï¼‰
â”œâ”€â”€ utils/                     # å·¥å…·ç±»
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ validators.py         # æ•°æ®éªŒè¯
â””â”€â”€ config/                   # é…ç½®æ–‡ä»¶
    â”œâ”€â”€ __init__.py
    â””â”€â”€ settings.py          # åº”ç”¨é…ç½®
```

## API ç«¯ç‚¹

### å¥åº·æ£€æŸ¥
```
GET /api/v1/health
```

### ç”Ÿæˆè¥å…»æ¨è
```
POST /api/v1/nutrition/recommendations
```

è¯·æ±‚ä½“ï¼š
```json
{
  "gender": "male|female",
  "age": 30,
  "height": 175.0,
  "weight": 70.0,
  "activity_level": "moderate",
  "health_goal": "maintain",
  "dietary_restrictions": ["ç´ é£Ÿ"],
  "health_conditions": ["ç³–å°¿ç—…"],
  "allergies": ["èŠ±ç”Ÿ"]
}
```

å“åº”ï¼š
```json
{
  "targets": {
    "calories": 2200.0,
    "protein": 110.0,
    "carbs": 275.0,
    "fat": 73.3
  },
  "recommendations": [
    "å»ºè®®æ¯æ—¥æ‘„å…¥2200å¡è·¯é‡Œ",
    "å¢åŠ é«˜è´¨é‡è›‹ç™½è´¨æ‘„å…¥",
    "æ§åˆ¶ç¢³æ°´åŒ–åˆç‰©æ‘„å…¥é‡"
  ],
  "meal_suggestions": [
    "æ—©é¤ï¼šç‡•éº¦ç²¥é…åšæœ",
    "åˆé¤ï¼šçƒ¤é¸¡èƒ¸è‚‰é…è”¬èœ",
    "æ™šé¤ï¼šé±¼ç±»é…ç³™ç±³"
  ],
  "metadata": {
    "calculation_method": "scientific",
    "model_version": "1.0.0",
    "generated_at": "2025-01-16T10:30:00"
  }
}
```

### æäº¤åé¦ˆ
```
POST /api/v1/nutrition/recommendations/{recommendation_id}/feedback
```

## è¥å…»è®¡ç®—ç®—æ³•

### åŸºç¡€ä»£è°¢ç‡ (BMR)
ä½¿ç”¨Mifflin-St Jeoræ–¹ç¨‹ï¼š
- ç”·æ€§ï¼šBMR = 10 Ã— ä½“é‡(kg) + 6.25 Ã— èº«é«˜(cm) - 5 Ã— å¹´é¾„ + 5
- å¥³æ€§ï¼šBMR = 10 Ã— ä½“é‡(kg) + 6.25 Ã— èº«é«˜(cm) - 5 Ã— å¹´é¾„ - 161

### æ€»èƒ½é‡æ¶ˆè€— (TDEE)
```python
activity_multipliers = {
    'sedentary': 1.2,     # ä¹…åä¸åŠ¨
    'light': 1.375,      # è½»åº¦æ´»åŠ¨
    'moderate': 1.55,    # ä¸­åº¦æ´»åŠ¨  
    'active': 1.725,     # æ´»è·ƒ
    'very_active': 1.9   # éå¸¸æ´»è·ƒ
}
```

### å®è¥å…»ç´ åˆ†é…
æ ¹æ®å¥åº·ç›®æ ‡è°ƒæ•´ï¼š
- å‡é‡ï¼šè›‹ç™½è´¨30%ï¼Œè„‚è‚ª35%ï¼Œç¢³æ°´35%
- å¢é‡ï¼šè›‹ç™½è´¨25%ï¼Œè„‚è‚ª30%ï¼Œç¢³æ°´45%
- ç»´æŒï¼šè›‹ç™½è´¨25%ï¼Œè„‚è‚ª30%ï¼Œç¢³æ°´45%

## è¿è¡Œæ–¹å¼

### æœ¬åœ°å¼€å‘
```bash
cd ai_service
pip install -r requirements.txt
python main.py
```

### Dockeréƒ¨ç½²
```bash
docker build -t ai-nutrition-service .
docker run -p 8001:8001 ai-nutrition-service
```

## é…ç½®è¯´æ˜

- æœåŠ¡ç«¯å£ï¼š8001
- æ—¥å¿—çº§åˆ«ï¼šINFO
- CORSï¼šå…è®¸æ‰€æœ‰æ¥æºï¼ˆå¼€å‘ç¯å¢ƒï¼‰

## æ‰©å±•è®¡åˆ’

1. **DeepSeekæ¨¡å‹é›†æˆ**ï¼šç”¨äºæ›´æ™ºèƒ½çš„æ¨èç”Ÿæˆ
2. **é£Ÿææ•°æ®åº“**ï¼šæ”¯æŒå…·ä½“é£Ÿç‰©æ¨è
3. **æœºå™¨å­¦ä¹ **ï¼šåŸºäºç”¨æˆ·åé¦ˆä¼˜åŒ–æ¨è
4. **å¤šè¯­è¨€æ”¯æŒ**ï¼šå›½é™…åŒ–åŠŸèƒ½
5. **ç¼“å­˜æœºåˆ¶**ï¼šæé«˜å“åº”é€Ÿåº¦

## ç›‘æ§å’Œæ—¥å¿—

- ä½¿ç”¨loguruè¿›è¡Œç»“æ„åŒ–æ—¥å¿—è®°å½•
- è®°å½•æ‰€æœ‰APIè¯·æ±‚å’Œé”™è¯¯
- æ”¯æŒç”Ÿäº§ç¯å¢ƒç›‘æ§é›†æˆ

## å®‰å…¨è€ƒè™‘

- è¾“å…¥æ•°æ®éªŒè¯
- é”™è¯¯ä¿¡æ¯è„±æ•
- å¥åº·çŠ¶å†µæ•°æ®ä¿æŠ¤
- APIè®¿é—®æ§åˆ¶ï¼ˆè®¡åˆ’ä¸­ï¼‰